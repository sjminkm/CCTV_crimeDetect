# CCTV_crimeDetect
## 20155129_손민성(객체검출,docker tensorflow_gpu_jupyter-notebook,이미지 캡셔닝,docker swarm,cluster ,fail over,ppt,깃허브,발표)
## 프로젝트 소개 및 개발 내용 소개
## realtime_crime_Detection
### 스마트 CCTV를 이용하여 특이사항을 검출하는 프로그램은 open source로 많이 존재한다. 하지만 이러한 프로그램들의 경우 대체적으로 공통적인 문제점이 발생하는것을 확인할수있다.
### 첫번째는 낮은 인식률이다. 기본적으로 다양한 환경에서 작동하는 CCTV의 특징상 시간의 변화와 그림자와 연관된 명암의 변화의 경우 제대로된 인식에서 조차 문제가 생기며
### 모션을 인식하여 폭력상황을 검출하는경우 실제적으로 인간의 몸에 선을 그려 모션을 인식하는데 손에 들고있는것이 가방이든 칼이든 선으로 나타나는 문제가 생겨 흉기를 사용한 폭력상황인지 아니면 가방이 흔들리며 뛰어가는 상황인지등을 구별해내지 못하는 문제등이 발생한다. 하지만 영상을 문장으로 바꾸면 어떨까? 비록 사람이 실제적으로 말하는 문장에 비하면 어색할지라도 단순히 이 상황이 어떤 상황인지를 알기위한 단어들만이 나타나질수있다면 충분한 구분의 대상이 될거라고 생각된다. 또한 이미지를 직접 전송하는것에 비해 문장을 전송한다면 전송에 사용되는 통신량과 저장에 필요한 스토리지공간이 획기적으로 줄어들수있고 실제 이미지를 확인시 주변의 다른사람의 프라이버시를 보호할수있도록 문제영역만을 검출해낼수있다면 보안적으로도 충분한 효과를 누릴수 있을것이다.

## 이에 따라 개발내용을 3가지로 분류하였다.
### 1. docker를 이용한 GPU_tensorflow 서버 생성
#### 해당 사항은 window 기반 docker를 기반으로 tensorflow/tensorflow:latest-gpu-jupyter 이미지를 사용하여 구동하였다.
#### host의 port를 연결한 포트포워딩 방식으로 외부에서 접속을 가능하게 설계하였고
#### docker swarm을 이용한 클러스터를 이용하여 1개의 manager와 2개의 worker노드를 설정하였다.
#### fail over 방식은 Active Standby를 이용하여 구현하였다.
#### 실제적으로 프로그램이 실행되자마자 바로 TCP소켓이 실행되도록 TCP_SERVER.py를 daemon으로 하여 systemctl을 통한 enable service로 구현하였다.

### 2. client에서 구동가능한 object detection 프로그램 (CCTV)
#### Tensorflow yoloV4를 기반으로한 object detection 프로그램을 기반으로 간단한 수정을 통해 원하는 이미지를 추출할수 있게끔 수정하였으며
#### TCP 소켓 통신을 통한 데이터 전송을 할수 있도록 코드를 작성하였다.

### 3. Server에서 구동가능한 image captioning 프로그램 
#### 최초 한국어와 영어 두가지 데이터를 사용하여 프로그래밍을 시도하였다.
#### 한국어의 경우 영어에 비해 단어의 조합이많아 vocab사이즈가 커졌으며 전처리에도 시간이 많이걸려 낮은 gpu성능상 out of memory가 발생되어 영어로 체택하였다.
#### 또한 높은 성능을 이끌어 내기위해서는 많은 데이터가 필요하나 1개의 이미지당 5개의 문장을 매핑시켰기에 이미지가 1만장이라면 문장이 5만여개가 되어버린다.
#### 이러한 문장 데이터셋이 존재하지 않아 직접 데이터셋을 마련해야하는데 이를 직접 마련하기엔 시간적문제가 커 실제적으로 googletrans를 사용하여 번역을 하였지만
#### 2020년 11월 26일 기준으로 일정횟수 이상 api사용시 google에서 ip를 차단시켜버려 데이터 마련에도 어려움을 겪었다.
#### 이에따라 기존에 많은 데이터가 존재한 ms coco 2017데이터셋을 사용하였으며 11만8천여개의 이미지와 60만여개의 캡셔닝된 문장을 데이터로 사용하여 학습을 진행하였다.

## 프로젝트 개발 결과물 소개 (+ 다이어그램)
### ㅎㅇㅁㄴㅎㅇㄴ


## 개발 결과물을 사용하는 방법 소개 (+ 프로그램 구동 화면 스크린 샷 첨부)
### server와 client를 나눠 각각 폴더안의 데이터를 넣어 사용하여도 무관하며
### 하나의 컴퓨터에 server와 detection을 같이넣어 구동하여도 문제없다.
### 결과물의 자세한 사용방법은 github의 각 server와 detection 폴더의 README.md를 참조하면 나와있으며
### 당연하지만 webcam이 필요하다.

## 개발 결과물의 필요성 및 활용방안
### 
